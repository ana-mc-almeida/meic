# MDX Queries <!-- omit in toc -->

- [Introduction](#introduction)
- [Syntax](#syntax)
- [Concepts](#concepts)
  - [Measures VS Dimensions](#measures-vs-dimensions)
  - [NON EMPTY](#non-empty)
  - [Slicing](#slicing)
  - [Navigation](#navigation)
    - [Members](#members)
    - [CHILDREN](#children)
    - [DRILLDOWNLEVEL](#drilldownlevel)
    - [DESCENDANTS](#descendants)
      - [SELF](#self)
      - [BEFORE](#before)
      - [SELF\_AND\_BEFORE](#self_and_before)
      - [AFTER](#after)
      - [SELF\_AND\_AFTER](#self_and_after)
      - [BEFORE\_AND\_AFTER](#before_and_after)
      - [SELF\_BEFORE\_AFTER](#self_before_after)
    - [ANCENDANTS](#ancendants)
  - [CROSSJOIN](#crossjoin)
  - [CALCULATED MEMBERS](#calculated-members)
    - [ALLMEMBERS](#allmembers)
  - [NAMED SETS](#named-sets)
  - [RELATIVE NAVIGATION](#relative-navigation)
    - [PARALLELPERIOD](#parallelperiod)
  - [FILTERING](#filtering)
    - [FILTER](#filter)
  - [SORTING](#sorting)
    - [ORDER](#order)
  - [TOP ANALSIS](#top-analsis)
    - [HEAD COUNT](#head-count)
    - [TOPCOUNT](#topcount)
    - [TOPPERCENT](#toppercent)
  - [OTHER FUNCTIONS](#other-functions)
    - [GENERATE](#generate)
    - [HI](#hi)

> Importante note: This document is a work in progress.  
> All information was generated by [Copilot](https://copilot.github.com/), just to check the topics that should be covered in the study guide.

## Introduction

MDX (Multidimensional Expressions) is a query language for OLAP databases, much like SQL is a query language for relational databases. MDX is used to query multidimensional data structures, such as cubes, and return the results in a tabular format.

## Syntax

The basic syntax for an MDX query is as follows:

```mdx
SELECT
    { [Measures].[<measure_name>] } ON COLUMNS,
    { [Dimension].[<dimension_name>] } ON ROWS
FROM
    [Cube_Name]
```

The `SELECT` statement is used to specify the dimensions and measures that you want to retrieve from the cube. The `ON COLUMNS` and `ON ROWS` clauses are used to specify the dimensions that you want to display on the columns and rows, respectively.

Use `[` and `]` to enclose the names of measures, dimensions, and members in MDX queries.

## Concepts

### Measures VS Dimensions

In MDX, measures are the numerical values that you want to retrieve from the cube, such as sales revenue, profit, or quantity sold. Measures are specified using the following syntax:

```mdx
[Measures].[<measure_name>]
```

Dimensions, on the other hand, are the categories or attributes that you want to use to organize and filter the data, such as product categories, time periods, or geographic regions. Dimensions are specified using the following syntax:

```mdx
[Dimension].[<dimension_name>]
```

### NON EMPTY

The `NON EMPTY` keyword is used to filter out empty cells from the result set. This is useful when you want to exclude rows or columns that have no data.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    NON EMPTY { [Product].[Category].[Category].Members } ON ROWS
FROM
    [SalesCube]
```

In this example, the `NON EMPTY` keyword is used to exclude any rows that have no sales data.

### Slicing

Slicing is the process of filtering the data in a cube by specifying a subset of the dimensions. For example, you can slice the data by a specific time period, product category, or geographic region.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { [Time].[2019].[Q1], [Time].[2019].[Q2] } ON ROWS
FROM
    [SalesCube]
```

In this example, the data is sliced by the time dimension to include only the first and second quarters of 2019.

> TODO: Explain the `WHERE` clause in MDX queries.

### Navigation

The fully qualified form is 
`
[Dimension].[Hierarchy].[Level].[Member]
`

#### Members

In MDX, members are the elements of a dimension. For example, in a time dimension, the members could be years, quarters, months, etc. Members are specified using the following syntax:

```mdx
[Dimension].[<member_name>]
```

#### CHILDREN

The `CHILDREN` function is used to retrieve the child members of a specified member in a dimension.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { [Product].[Category].[Category].CHILDREN } ON ROWS
FROM
    [SalesCube]
```

In this example, the `CHILDREN` function is used to retrieve the child categories of the top-level category in the product dimension.

#### DRILLDOWNLEVEL

The `DRILLDOWNLEVEL` function is used to retrieve the members of a specified level in a dimension.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { [Time].[Year].DRILLDOWNLEVEL } ON ROWS
FROM
    [SalesCube]
```

In this example, the `DRILLDOWNLEVEL` function is used to retrieve the years in the time dimension.

#### DESCENDANTS

The `DESCENDANTS` function is used to retrieve all the descendants of a specified member in a dimension.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { DESCENDANTS([Time].[2019], [Time].[Month]) } ON ROWS
FROM
    [SalesCube]
```

In this example, the `DESCENDANTS` function is used to retrieve all the months in the year 2019.

##### SELF

> TODO

##### BEFORE

> TODO

##### SELF_AND_BEFORE

> TODO

##### AFTER

> TODO

##### SELF_AND_AFTER

> TODO

##### BEFORE_AND_AFTER

> TODO

##### SELF_BEFORE_AFTER

> TODO

#### ANCENDANTS

The `ANCESTORS` function is used to retrieve all the ancestors of a specified member in a dimension.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { ANCESTORS([Time].[2019].[Q1], [Time].[Year]) } ON ROWS
FROM
    [SalesCube]
```

### CROSSJOIN

The `CROSSJOIN` function is used to combine the members of two or more dimensions into a single set.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { CROSSJOIN([Product].[Category].[Category].Members, [Time].[Year].[Year].Members) } ON ROWS
FROM
    [SalesCube]
```

In this example, the `CROSSJOIN` function is used to combine the product categories and years into a single set.

### CALCULATED MEMBERS

Calculated members are members that are defined in the MDX query itself, rather than being part of the cube structure. Calculated members are useful for performing calculations on the fly, such as calculating the percentage of total sales for each product category.

```mdx
WITH
    MEMBER [Measures].[SalesPercentage] AS
        [Measures].[Sales] / ([Measures].[Sales], [Product].[Category].[All])
SELECT
    { [Measures].[Sales], [Measures].[SalesPercentage] } ON COLUMNS,
    { [Product].[Category].[Category].Members } ON ROWS
FROM
    [SalesCube]
```

In this example, a calculated member called `SalesPercentage` is defined to calculate the percentage of total sales for each product category.

#### ALLMEMBERS

> TODO

### NAMED SETS

Named sets are predefined sets of members that can be reused in MDX queries. Named sets are useful for simplifying complex queries and improving query performance.

```mdx
WITH
    SET [Top5Products] AS
        TOPCOUNT([Product].[Product].[Product].Members, 5, [Measures].[Sales])
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { [Top5Products] } ON ROWS
FROM
    [SalesCube]
```

### RELATIVE NAVIGATION

> TODO

#### PARALLELPERIOD

> TODO

### FILTERING

#### FILTER

The `FILTER` function is used to filter a set of members based on a specified condition.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { FILTER([Product].[Category].[Category].Members, [Measures].[Sales] > 1000) } ON ROWS
FROM
    [SalesCube]
```

In this example, the `FILTER` function is used to filter the product categories based on the sales amount.

### SORTING

#### ORDER

The `ORDER` function is used to sort a set of members based on a specified measure.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { ORDER([Product].[Category].[Category].Members, [Measures].[Sales], DESC) } ON ROWS
FROM
    [SalesCube]
```

In this example, the `ORDER` function is used to sort the product categories based on the sales amount in descending order.

### TOP ANALSIS

#### HEAD COUNT

> TODO

#### TOPCOUNT

The `TOPCOUNT` function is used to retrieve the top N members of a set based on a specified measure.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { TOPCOUNT([Product].[Category].[Category].Members, 5, [Measures].[Sales]) } ON ROWS
FROM
    [SalesCube]
```

#### TOPPERCENT

The `TOPPERCENT` function is used to retrieve the top N percent of members of a set based on a specified measure.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { TOPPERCENT([Product].[Category].[Category].Members, 20, [Measures].[Sales]) } ON ROWS
FROM
    [SalesCube]
```

### OTHER FUNCTIONS

#### GENERATE

The `GENERATE` function is used to generate a set of members based on a specified set and a function.

```mdx
SELECT
    { [Measures].[Sales] } ON COLUMNS,
    { GENERATE([Product].[Category].[Category].Members, [Product].[Category].CurrentMember.Children) } ON ROWS
FROM
    [SalesCube]
```

In this example, the `GENERATE` function is used to generate the child categories of each product category.

#### HI
